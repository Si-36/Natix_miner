# NATIX Dataset Configuration
# Latest 2025-2026 Practices
#
# NATIX StreetVision:
#   - Roadwork classification
#   - 7 classes
#   - ~10K images (estimated)
#   - Real-world street conditions

# Dataset paths (FIXED: Absolute path + 13 classes)
data_root: /data/natix  # TODO: Override with your actual path via CLI
train_csv: ${data_root}/train.csv
val_csv: ${data_root}/val.csv
test_csv: ${data_root}/test.csv

# Classes (FIXED: 13 classes for NATIX roadwork, NOT 7!)
num_classes: 13
class_names:
  - no_roadwork
  - construction_site
  - road_damage
  - pothole
  - crack
  - roadwork_sign
  - barrier
  - cone
  - equipment
  - worker
  - material
  - marking
  - other

# Class weights (auto-computed if null)
class_weights: null  # Will be computed from training data

# Data splits (4-way split for zero leakage)
splits:
  train_ratio: 0.7
  val_select_ratio: 0.1  # For model selection (early stopping)
  val_calib_ratio: 0.1   # For policy fitting (threshold, gate, SCRC)
  val_test_ratio: 0.1    # For final evaluation ONLY

# Image preprocessing
preprocessing:
  resize: 224  # DINOv3 standard resolution
  crop_size: 224
  mean: [0.485, 0.456, 0.406]  # ImageNet mean
  std: [0.229, 0.224, 0.225]   # ImageNet std
  interpolation: bilinear

# Data loading
dataloader:
  batch_size: 32
  num_workers: 8
  pin_memory: true
  persistent_workers: true
  prefetch_factor: 2

# Augmentation (train)
augmentation:
  train:
    horizontal_flip: 0.5
    vertical_flip: 0.0
    rotation: 15
    color_jitter:
      brightness: 0.4
      contrast: 0.4
      saturation: 0.4
      hue: 0.1
    auto_augment: true
    random_erasing: 0.1

  # No augmentation for val/test
  val:
    resize: 224
    crop_size: 224
    center_crop: true

# Multi-view settings
multiview:
  enabled: true
  global_crop:
    size: 224
    scale: [0.8, 1.0]

  local_crops:
    enabled: true
    num_crops: 9  # 3x3 grid
    size: 75      # 224 / 3 (rounded)
    scale: [0.3, 0.8]

# Slice-based evaluation
slicing:
  enabled: true
  slices:
    - name: day
      filter: time_of_day == "day"
    - name: night
      filter: time_of_day == "night"
    - name: clear
      filter: weather == "clear"
    - name: rain
      filter: weather == "rain"
    - name: snow
      filter: weather == "snow"

# Data quality checks
quality:
  min_image_size: 224  # Minimum image dimension
  max_aspect_ratio: 3.0  # Reject extreme aspect ratios
  check_corrupted: true  # Check for corrupted images
